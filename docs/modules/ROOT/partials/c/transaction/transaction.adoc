[#_methods_transaction_transaction]
=== transaction

[#_Struct_Transaction]
[.doc-api-reference-driver]
==== Struct Transaction

`rust struct (pointer)`



A transaction with a TypeDB database.

[#_transaction_analyze]
===== function ``transaction_analyze``

[source,c]
----
struct AnalyzedQueryPromise* transaction_analyze(struct Transaction* transaction, const char* query)
----



Analyzes a TypeQL query in the transaction.


[caption=""]
.Input parameters
[cols=",,"]
[options="header"]
|===
|Name |Description |Type
a| `transaction` a| The ``Transaction`` to analyze the query within. a| `struct Transaction*`
a| `query` a| The query string. a| `const char*`
|===

[caption=""]
.Returns
`struct AnalyzedQueryPromise*`

[#_transaction_close]
===== function ``transaction_close``

[source,c]
----
struct VoidPromise* transaction_close(struct Transaction* txn)
----



Forcibly closes this transaction. To be used in exceptional cases.

[caption=""]
.Returns
`struct VoidPromise*`

[#_transaction_commit]
===== function ``transaction_commit``

[source,c]
----
struct VoidPromise* transaction_commit(struct Transaction* txn)
----



Commits the changes made via this transaction to the TypeDB database. Whether or not the transaction is commited successfully, the transaction is closed after the commit call and the native rust object is freed.

[caption=""]
.Returns
`struct VoidPromise*`

[#_transaction_is_open]
===== function ``transaction_is_open``

[source,c]
----
bool transaction_is_open(const struct Transaction* txn)
----



Checks whether this transaction is open.

[caption=""]
.Returns
`bool`

[#_transaction_new]
===== function ``transaction_new``

[source,c]
----
struct Transaction* transaction_new(struct TypeDBDriver* driver, const char* database_name, enum TransactionType type_, const struct TransactionOptions* options)
----



Opens a transaction to perform read or write queries on the database connected to the session.


[caption=""]
.Input parameters
[cols=",,"]
[options="header"]
|===
|Name |Description |Type
a| `databases` a| The ``DatabaseManager`` object on this connection. a| 
a| `database_name` a| The name of the database with which the transaction connects. a| `const char*`
a| `type_` a| The type of transaction to be created (Write / Read / Schema). a| `enum TransactionType`
a| `options` a| ``TransactionOptions`` to configure the opened transaction. a| `const struct TransactionOptions*`
|===

[caption=""]
.Returns
`struct Transaction*`

[#_transaction_on_close]
===== function ``transaction_on_close``

[source,c]
----
struct VoidPromise* transaction_on_close(const struct Transaction* txn, uintptr_t callback_id, void(*)(uintptr_t, struct Error*) callback)
----



Registers a callback function which will be executed when this transaction is closed.


[caption=""]
.Input parameters
[cols=",,"]
[options="header"]
|===
|Name |Description |Type
a| `txn` a| The transaction on which to register the callback a| `const struct Transaction*`
a| `callback_id` a| The argument to be passed to the callback function when it is executed. a| `uintptr_t`
a| `callback` a| The function to be called a| 
|===

[caption=""]
.Returns
`struct VoidPromise*`

[#_transaction_query]
===== function ``transaction_query``

[source,c]
----
struct QueryAnswerPromise* transaction_query(struct Transaction* transaction, const char* query, const struct QueryOptions* options)
----



Performs a TypeQL query in the transaction.


[caption=""]
.Input parameters
[cols=",,"]
[options="header"]
|===
|Name |Description |Type
a| `transaction` a| The ``Transaction`` to execute the query within. a| `struct Transaction*`
a| `query` a| The query string. a| `const char*`
a| `options` a| ``QueryOptions`` to configure the executed query. a| `const struct QueryOptions*`
|===

[caption=""]
.Returns
`struct QueryAnswerPromise*`

[#_transaction_rollback]
===== function ``transaction_rollback``

[source,c]
----
struct VoidPromise* transaction_rollback(const struct Transaction* txn)
----



Rolls back the uncommitted changes made via this transaction.

[caption=""]
.Returns
`struct VoidPromise*`

[#_transaction_submit_close]
===== function ``transaction_submit_close``

[source,c]
----
void transaction_submit_close(struct Transaction* txn)
----



Closes the transaction and frees the native rust object.

[caption=""]
.Returns
`void`

